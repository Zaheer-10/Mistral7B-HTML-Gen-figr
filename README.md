# Mistral7B-HTML-Gen-figr

Welcome to the repository, where I've fine-tuned the [Mistral 7B](https://huggingface.co/mistralai/Mistral-7B-v0.1) model specifically for the generation of HTML code.

![Mistral](data:image/jpeg;base64,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)
#### **Objectives Addressed**

 1. Model Section.
 2. Data Preparation.
 3. Tokenization.
 4. Fine-Tuning with LoRA
 5. Evaluation
 6. API dev

##  Objective

The primary goal of this assignment was to fine-tune the Mistral 7B model for generating HTML code from natural language prompts.

## Dataset

I utilized the `jawerty/html_dataset` from Hugging Face Datasets, containing 43 examples of natural language prompts paired with corresponding HTML code.

## Model Selection and Architecture

- At the core of Mistral 7B lies a [Transformer architecture](https://datagen.tech/guides/computer-vision/transformer-architecture/#:~:text=The%20Transformer%20architecture%20uses%20an%20encoder-decoder%20structure%20that,previous%20time%20step%2C%20and%20generates%20an%20output%20sequence.), a fundamental component of modern language models. Nevertheless, it introduces several groundbreaking innovations that contribute to its exceptional performance. In comparison to [Llama](https://github.com/openlm-research/open_llama), it brings about some significant changes:
![enter image description here](https://cdn.labellerr.com/1%20mistral%207b/architecture.webp)
- The Mistral 7B model, a 7.3B parameter transformer with Grouped-query attention (GQA) and Sliding Window Attention (SWA), was selected for its optimal balance between performance and efficiency. GQA enhances inference speed, while SWA handles longer sequences effectively.


## Data Preparation

I carefully prepared the data by splitting it into training and testing sets, adding special tokens, padding, and masking. Token distribution visualizations were employed, experimenting with LangChain Recursive Splitter and SWA features to handle large token lengths in HTML code.

## Fine-Tuning with LoRA

The fine-tuning process involved the use of Low Rank Adaptation (LoRA), a parameter-efficient approach that outperformed full finetuning in certain cases. 
![enter image description here](https://miro.medium.com/v2/resize:fit:1400/1*rOW5plKBuMlGgpD0SO8nZA.png)

Leveraging the Hugging Face PEFT library, I set hyperparameters based on model documentation and employed the PyTorch Trainer class for efficient training. WandB was used for visualization and tracking during training.

## API Development

To facilitate user interaction with the fine-tuned model, I implemented an API using Flask. Users can input natural language queries, and the model will generate corresponding HTML code. This enhances the practical application of the model by making it accessible and user-friendly.

## Evalua**strong text**tion

The model's performance was evaluated using ROUGE scores (1, 2, L), perplexity, and visual inspection of generated HTML code. WandB facilitated result logging and comparison between different data preparation methods.

## Challenges Faced

Challenges included **GPU interruptions** during training in Colab, **handling large token lengths** in HTML codes, and the **complexity of tensor manipulation** and **training parameters**.

## Documentation
Check out the documentation at this link -> [Access HereðŸ‘†](https://zaheer.gitbook.io/figr-tuning/)

## Conclusion

In conclusion, my journey from model selection to fine-tuning, evaluation, and API development has been both challenging and rewarding. Thank you for reading, and I hope you find this [Readme.md](https://github.com/Zaheer-10/Mistral7B-HTML-Gen-figr/README.md) was helpful and informative.

## License

This project is licensed under the terms of the MIT license. See the [LICENSE](https://opensource.org/license/mit/) file for details.
